<metal:block metal:use-macro="context/@@layout/macros/page">
<div metal:fill-slot='content'>

<div tal:repeat="event view/events"
     tal:define="global lastStart python:None">
<h1 tal:condition="python:lastStart!=event.start.day"
    tal:content="python:event.start.strftime('%A')">Dayname</h1>

<a name="now"
   tal:condition="python: event == view.anchorEvent">
  <tal:block metal:define-macro="eventContainer">
    <span tal:condition="python: event.start <= view.now and view.now < event.end"
          tal:replace="structure python: '<div class=\'now\'>'" />
    <span tal:replace="python:event.start.strftime('%H:%M')" />
    <a tal:content="event/name"
       tal:attributes="href event/url">Event name</a>

    <span tal:condition="python: event.length > view.zeroSeconds"
          tal:replace="event/timeString" />

    <a class="loc" tal:content="event/locationName"
       tal:attributes="href event/locationUrl">Location name</a>
    <span tal:condition="python: event.start <= view.now and view.now < event.end"
          tal:replace="structure python: '</div>'" />

  </tal:block>
</a>

<tal:block tal:condition="python: event != view.anchorEvent">
  <span metal:use-macro="view/macros/eventContainer" />
</tal:block>

<span tal:condition="python: False"
      tal:define="global lastStart python:event.start.day" />
</div>

</div>
</metal:block >
